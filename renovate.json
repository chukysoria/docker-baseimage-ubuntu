{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "local>chukysoria/renovate-config",
    "local>chukysoria/renovate-config:docker-build",
    "local>chukysoria/renovate-config:os-package(ubuntu_22_04)",
    "local>chukysoria/renovate-config:os-package(ubuntu_24_04)"
  ],
  "baseBranches": [
    "jammy",
    "noble"
  ],
  "customManagers": [
    {
      "fileMatch": [
        "(^|/)Dockerfile$"
      ],
      "matchStrings": [
        "ARG S6_OVERLAY_VERSION=[\"']?(?<currentValue>.+?)[\"']?\\s+"
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "just-containers/s6-overlay"
    },
    {
      "fileMatch": [
        "(^|/)Dockerfile$"
      ],
      "matchStrings": [
        "ARG BUILD_EXT_RELEASE=[\"']?(?<depName>.+?)[\"']?\\s+ARG BUILD_EXT_BUILD=[\"']?(?<currentValue>.+?)[\"']?\\s+"
      ],
      "versioningTemplate": "loose",
      "datasourceTemplate": "custom.ubuntu-core"
    },
    {
      "fileMatch": [
        "(^|/)Dockerfile$",
        "(^|/)config.yaml$"
      ],
      "matchStrings": [
        "ARG BUILD_EXT_RELEASE=[\"']?(?<currentValue>.+?)[\"']?\\s+",
        "ext_release: (?<currentValue>.+)\\s+"
      ],
      "versioningTemplate": "ubuntu",
      "datasourceTemplate": "docker",
      "depNameTemplate": "public.ecr.aws/lts/ubuntu"
    }
  ],
  "customDatasources": {
    "ubuntu-core": {
      "defaultRegistryUrlTemplate": "https://cloud-images.ubuntu.com/releases/streams/v1/com.ubuntu.cloud:released:download.json",
      "format": "json",
      "transformTemplates": [
        "{'releases': [$.products.*[release='{{{depName}}}'][arch='amd64'].versions.$keys().{'version': $,'releaseTimestamp': $&'T00:00Z'}]}"
      ]
    }
  },
  "packageRules": [
    {
      "matchPackageNames": [
        "just-containers/s6-overlay"
      ],
      "versioning": "regex:^v?(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)\\.(?<build>\\d+)$",
      "extractVersion": "^v(?<version>.*)$"
    },
    {
      "matchDatasources": [
        "ubuntu-core"
      ],
      "matchBaseBranches": [
        "jammy"
      ],
      "excludePackageNames": ["jammy"],
      "enabled": false
    },
    {
      "matchDepPrefixes": [
        "ubuntu"
      ],
      "excludeDepPrefixes":[
        "ubuntu_22_04"
      ],
      "matchBaseBranches": [
        "jammy"
      ],
      "enabled": false 
    },
    {
      "matchDatasources": [
        "ubuntu-core"
      ],
      "matchBaseBranches": [
        "noble"
      ],
      "excludePackageNames": ["noble"],
      "enabled": false
    },
    {
      "matchDepPrefixes": [
        "ubuntu"
      ],
      "excludeDepPrefixes": [
        "ubuntu_24_04"
      ],
      "matchBaseBranches": [
        "noble"
      ],
      "enabled": false
    }
  ]
}